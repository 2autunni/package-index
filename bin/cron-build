#!/usr/bin/env bash

# This script is run hourly by Cron.

# fail on first error
set -e

cd $HOME/package-index

# update the gh-pages branch
cd web/
git pull
cd -

# update the master branch
git pull
CURRENT_REV=$(git rev-parse HEAD)

$HOME/satis/bin/satis build

cd web/
if git commit -am "build: $CURRENT_REV"
then
	git push origin gh-pages
fi
